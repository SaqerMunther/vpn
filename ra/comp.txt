<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:c="http://xmlns.jcp.org/jsp/jstl/core"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

  <!-- Cache heavy expressions using ui:param -->
  <ui:param name="covThirdRow" value="#{mbMain.getCoverageFirstRow(0)}" />

  <div class="full CMON-Gradient bold lg primary RADAR-Country" style="padding: 0.3vw 0.75vw">
    Compliance 
    <span style="float: right; margin: 4px; font-size: 1vw;">
      Duration Date :
      <h:outputText value="#{radarController.date1}">
        <f:convertDateTime dateStyle="short" pattern="yyyy-MM-dd" />
      </h:outputText>
    </span>
  </div>
  <!-- Compliance Items -->
  <div class="full flex" style="margin-top: 2vh">
    <!-- Header Row -->
    <div class="full flex spaced" style="font-size: 0.6vw;">
      <div class="flex spaced" style="flex-basis: 6%;"></div>
      <p:outputPanel styleClass="quarter flex spaced rounded-corners primary"
                     style="padding: 0.2vw 0.5vw;display: contents">
        <div class="bold small-title">
          Compliance before 2 months
        </div>
      </p:outputPanel>
      <p:outputPanel styleClass="quarter flex spaced rounded-corners primary"
                     style="padding: 0.2vw 0.5vw;display: contents">
        <div class="bold small-title">
          Compliance before 1 month
        </div>
      </p:outputPanel>
      <p:outputPanel styleClass="quarter flex spaced rounded-corners primary"
                     style="padding: 0.2vw 0.5vw;">
        <div class="bold small-title">
          Compliance today
        </div>
      </p:outputPanel>
    </div>
    <!-- First Row: IT Compliance -->
    <div class="full flex spaced" style="margin-top: 1vh">
      <!-- IT Label -->
      <p:tooltip for="comp_it" value="Compliance score as per IT calculations today, last 1 and 2 months" />
      <p:outputPanel id="comp_it" styleClass="col-1 lg bold" style="margin-top: 5px;">
        IT
      </p:outputPanel>
      <!-- 2 Months IT -->
      <ui:param name="compTwoIT" value="#{mbMain.getCompUpperDataHis(2, 0)}" />
      <p:tooltip for="it_two" value="Compliance Status 2 Months Ago as per IT Measurement" />
      <p:outputPanel id="it_two" styleClass="col-2 flex spaced bg-white shadow rounded-corners xl primary"
                     style="padding: 0.2vw 0.3vw">
        <div class="regular">
          <h:outputText value="#{compTwoIT.first}">
            <f:convertNumber maxFractionDigits="2" />
          </h:outputText>%
        </div>
        <div class="column-flex sm bold">
          <div id="k1">#{compTwoIT.second}</div>
          <hr/>
          <div>#{compTwoIT.third}</div>
        </div>
      </p:outputPanel>
      <!-- 1 Month IT -->
      <ui:param name="compOneIT" value="#{mbMain.getCompUpperDataHis(1, 0)}" />
      <p:tooltip for="it_one" value="Compliance Status 1 Month Ago as per IT Measurement" />
      <p:outputPanel id="it_one" styleClass="col-2 flex spaced bg-white shadow rounded-corners xl primary"
                     style="padding: 0.2vw 0.3vw">
        <div class="regular">
          <h:outputText value="#{compOneIT.first}">
            <f:convertNumber maxFractionDigits="2" />
          </h:outputText>%
        </div>
        <div class="column-flex sm bold">
          <div id="k2">#{compOneIT.second}</div>
          <hr/>
          <div>#{compOneIT.third}</div>
        </div>
      </p:outputPanel>
      <!-- Today IT -->
      <ui:param name="compTodayIT" value="#{mbMain.getCompUpperData(0, 0)}" />
      <p:tooltip for="it_zero" value="Compliance Status Today as per IT Measurement" />
      <p:outputPanel id="it_zero" styleClass="col-2 flex spaced bg-white shadow rounded-corners xl primary"
                     style="padding: 0.2vw 0.3vw; background-color:#{mbMain.getComplianceTodaythreshold(compTodayIT.first)}; color:#{mbMain.getComplianceTodaythreshold(compTodayIT.first) eq 'white' ? '#37538C' : 'white !important'}">
        <div class="regular">
          <h:outputText value="#{compTodayIT.first}">
            <f:convertNumber maxFractionDigits="2" />
          </h:outputText>%
        </div>
        <div class="column-flex sm bold">
          <div id="k3">#{compTodayIT.second}</div>
          <hr/>
          <div>#{compTodayIT.third}</div>
        </div>
      </p:outputPanel>
    </div>
    <!-- First Row: Risk Compliance -->
    <div class="full flex spaced" style="margin-top: 2vh">
      <!-- Risk Label -->
      <p:tooltip for="comp_buss" value="Compliance score as per Risk KPIs calculations today, last 1 and 2 months" />
      <p:outputPanel id="comp_buss" styleClass="col-1 lg bold" style="margin-top: 5px;">
        Risk
      </p:outputPanel>
      <!-- 2 Months Risk -->
      <ui:param name="compTwoRisk" value="#{mbMain.getCompUpperDataHis(2, 1)}" />
      <p:tooltip for="risk_two" value="Compliance Status 2 Months Ago as per Risk Measurement" />
      <p:outputPanel id="risk_two" styleClass="col-2 flex spaced bg-white shadow rounded-corners xl primary"
                     style="padding: 0.2vw 0.3vw">
        <div class="regular">
          <h:outputText value="#{compTwoRisk.first}">
            <f:convertNumber maxFractionDigits="2" />
          </h:outputText>%
        </div>
        <div class="column-flex sm bold">
          <div id="k4">#{compTwoRisk.second}</div>
          <hr/>
          <div>#{compTwoRisk.third}</div>
        </div>
      </p:outputPanel>
      <!-- 1 Month Risk -->
      <ui:param name="compOneRisk" value="#{mbMain.getCompUpperDataHis(1, 1)}" />
      <p:tooltip for="risk_one" value="Compliance Status 1 Month Ago as per Risk Measurement" />
      <p:outputPanel id="risk_one" styleClass="col-2 flex spaced bg-white shadow rounded-corners xl primary"
                     style="padding: 0.2vw 0.3vw">
        <div class="regular">
          <h:outputText value="#{compOneRisk.first}">
            <f:convertNumber maxFractionDigits="2" />
          </h:outputText>%
        </div>
        <div class="column-flex sm bold">
          <div id="k5">#{compOneRisk.second}</div>
          <hr/>
          <div>#{compOneRisk.third}</div>
        </div>
      </p:outputPanel>
      <!-- Today Risk -->
      <ui:param name="compTodayRisk" value="#{mbMain.getCompUpperData(0, 1)}" />
      <p:tooltip for="risk_zero" value="Compliance Status Today as per Risk Measurement" />
      <p:outputPanel id="risk_zero" styleClass="col-2 flex spaced bg-white shadow rounded-corners xl primary"
                     style="padding: 0.2vw 0.3vw">
        <div class="regular">
          <h:outputText value="#{compTodayRisk.first}">
            <f:convertNumber maxFractionDigits="2" />
          </h:outputText>%
        </div>
        <div class="column-flex sm bold">
          <div id="k6">#{compTodayRisk.second}</div>
          <hr/>
          <div>#{compTodayRisk.third}</div>
        </div>
      </p:outputPanel>
    </div>
    <!-- ROW END -->
  </div>
  
  <!-- Lower Compartment: The rest of the page remains unchanged. All EL calls that were repeated have been replaced by cached ui:param values -->
  
  <style>
    li {
      background-color:#C3ECFB !important;
      border-radius: 10px !important;
      border-style: solid;
      border-color: white;
    }
    body .ui-menu .ui-menu-list .ui-widget-header h3 {
      font-weight: bold;
      font-size:1vw;
      color: #37538C !important;
      text-align: center;
    }
    body .ui-menu .ui-menu-list .ui-menuitem {
      background-color: white !important;
      font-size:0.1vw;
      text-align: center;
      border: unset;
      border-radius: 0 !important;
      display: flex;
      align-content: center;
      justify-content: center;
    }
    body .ui-menu .ui-menu-list .ui-menuitem .ui-menuitem-link {
      margin:5px;
      display: flex !important;
      justify-content: center;
      align-items: center;
    }
    body .ui-menu.ui-menu-toggleable .ui-menu-list .ui-widget-header {
      border: unset;
      box-shadow: 0 0.25vw 0.5vw #0001;
      border-radius: 0 !important;
    }
    body .ui-menu.ui-menu-toggleable .ui-menu-list .ui-widget-header:nth-child(odd) {
      background: #DAF0FF !important;
    }
    body .ui-menu.ui-menu-toggleable .ui-menu-list .ui-widget-header:nth-child(even) {
      background: #E5F5FF !important;
    }
  </style>
</html>
